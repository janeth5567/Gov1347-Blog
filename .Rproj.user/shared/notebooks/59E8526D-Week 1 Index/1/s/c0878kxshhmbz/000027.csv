"0",""
"0","popvote_wide_df <- popvote_wide_df %>%"
"0","mutate(winner = case_when(D != ""NA"" ~ ""Democrat"","
"0","TRUE ~ ""Republican""))"
"0",""
"0","# start with 114th congress - 2014 election"
"0","# required packages"
"0","require(tidyverse)"
"0","require(ggplot2)"
"0","require(sf)"
"0","# load geographic data"
"0","get_congress_map <- function(cong=114) {"
"0","tmp_file <- tempfile()"
"0","tmp_dir <- tempdir()"
"0","zp <- sprintf(""https://cdmaps.polisci.ucla.edu/shp/districts114.zip"",cong)"
"0","download.file(zp, tmp_file)"
"0","unzip(zipfile = tmp_file, exdir = tmp_dir)"
"0","fpath <- paste(tmp_dir, sprintf(""districtShapes/districts114.shp"",cong), sep = ""/"")"
"0","st_read(fpath)"
"0","}"
"0","# load 114th congress"
"0","cd114 <- get_congress_map(114)"
"2","Warning: one argument not used by format 'https://cdmaps.polisci.ucla.edu/shp/districts114.zip'"
"2","trying URL 'https://cdmaps.polisci.ucla.edu/shp/districts114.zip'
"
"2","Content type 'application/zip'"
"2"," length 61656606 bytes (58.8 MB)
"
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","
"
"2","downloaded 58.8 MB

"
"2","Warning: one argument not used by format 'districtShapes/districts114.shp'"
"1","Reading layer `"
"1","districts114"
"1","' from data source "
"1","
"
"1","  "
"1","`"
"1","/private/var/folders/mv/pwxqfd411cz090w_kkkl3mn00000gn/T/RtmpHyUdzK/districtShapes/districts114.shp"
"1","' "
"1","
"
"1","  "
"1","using driver `"
"1","ESRI Shapefile"
"1","'"
"1","
"
"1","Simple feature collection with 436 features and 15 fields"
"1"," (with 1 geometry empty)"
"1","
"
"1","Geometry type: MULTIPOLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -179.1473 ymin: 18.91383 xmax: 179.7785 ymax: 71.35256"
"1","
"
"1","Geodetic CRS:  NAD83
"
"0","h <- read_csv(""~/Desktop/Syllabi for Fall 22/election analytics/Gov1347 Data/house party vote share by district 1948-2020.csv"")"
"2","[1mRows: [22m[34m16067[39m [1mColumns: [22m[34m31[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[31mchr[39m (16): Office, State, Area, RepCandidate, RepStatus, DemCandidate, DemStatu...
[32mdbl[39m (14): raceYear, RepVotes, DemVotes, ThirdVotes, OtherVotes, PluralityVotes...
[33mlgl[39m  (1): CensusPop"
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","# filter for relevant variables"
"0","R_2016 <- h %>%"
"0","filter(raceYear == 2016) %>%"
"0","select(raceYear, State, district_num, district_id, RepVotes, DemVotes) %>%"
"0","# summarize party vote share by state"
"0","group_by(State) %>%"
"0","# mutate Rep vote margin by state %>%"
"0","mutate(R_votemargin_st = (sum(RepVotes))/"
"0","sum(RepVotes + DemVotes),"
"0","D_votemargin_st = (sum(DemVotes))/"
"0",""
"0","sum(RepVotes + DemVotes)) %>%"
"0",""
"0","rename(state = State)"
"0",""
"0",""
"0","# load usmap"
"0","# install.packages('plot_usmap')"
"0","library(usmap)"
"0","states_map <- usmap::us_map()"
"0","unique(states_map$abbr)"
"1"," [1]"
"1"," ""AL"""
"1"," ""AK"""
"1"," ""AZ"""
"1"," ""AR"""
"1"," ""CA"""
"1"," ""CO"""
"1"," ""CT"""
"1"," ""DE"""
"1"," ""DC"""
"1"," ""FL"""
"1"," ""GA"""
"1"," ""HI"""
"1"," ""ID"""
"1"," ""IL"""
"1"," ""IN"""
"1","
"
"1","[16]"
"1"," ""IA"""
"1"," ""KS"""
"1"," ""KY"""
"1"," ""LA"""
"1"," ""ME"""
"1"," ""MD"""
"1"," ""MA"""
"1"," ""MI"""
"1"," ""MN"""
"1"," ""MS"""
"1"," ""MO"""
"1"," ""MT"""
"1"," ""NE"""
"1"," ""NV"""
"1"," ""NH"""
"1","
"
"1","[31]"
"1"," ""NJ"""
"1"," ""NM"""
"1"," ""NY"""
"1"," ""NC"""
"1"," ""ND"""
"1"," ""OH"""
"1"," ""OK"""
"1"," ""OR"""
"1"," ""PA"""
"1"," ""RI"""
"1"," ""SC"""
"1"," ""SD"""
"1"," ""TN"""
"1"," ""TX"""
"1"," ""UT"""
"1","
"
"1","[46]"
"1"," ""VT"""
"1"," ""VA"""
"1"," ""WA"""
"1"," ""WV"""
"1"," ""WI"""
"1"," ""WY"""
"1","
"
